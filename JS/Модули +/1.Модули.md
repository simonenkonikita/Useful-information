## Модули

Модуль — обычно отдельный файл с кодом, фрагмент программы, который реализует часть её функциональности.

### Подключение и использование модуля

Браузер должен понять, что на сайте используются модули. \
Для этого при подключении скриптов нужно задать значение module атрибуту type:

<script type="module" src="script-01.js"></script>
<script type="module" src="script-02.js"></script>

### Область видимости

У модуля своя область видимости. \
Он содержит локальные переменные и функции, которые не загрязняют глобальную область. Но если они нужны где-то снаружи, их придётся экспортировать:

```javascript
export const numbers = [2, 3, 5];
```

```javascript
import { numbers } from "./constants.js";

const doubledNumbers = numbers.map((number) => number * 2);

console.log(doubledNumbers); // [4, 6, 10]
```

```html
<script type="module" src="index.js"></script>
<script type="module" src="constants.js"></script>

<script>
  console.log(numbers); // ошибка — такой переменной в глобальной области нет
  console.log(doubledNumbers); // и такой тоже нет
</script>
```

### Старые браузеры

В старых браузерах атрибута type="module" не существует. \
Поэтому если открыть сайт в браузере, который не поддерживает модули, JavaScript вообще не будет подключён.

Это можно обойти так: пишут отдельный код для старых браузеров и подключают отдельно. \
То есть дописывают ещё один тег <script>, а в его атрибут type записывают значение "nomodule".

<!-- этот модуль загрузится, если браузер современный -->
<script type="module"></script>
<!-- этот модуль загрузится, если браузер старый -->
<script type="nomodule"></script>

Но так поступают редко. Чаще используют сборку.

### Модули — после отрисовки

Модули всегда подключаются к странице после отрисовки. \
Поэтому неважно, где вы их подключаете — в начале или в конце файла.

```html
<script>
  console.log(document.querySelector('input')); // null

  /* без модулей такое не сработает, потому что поле ввода
  объявлено в коде ниже, а значит, мы пока не можем работать с ним */
</script>

<script type="module">
  console.log(document.querySelector('input')); // <input>

  /* при модульном подходе таких проблем нет */
</script>

<input type="text"></input>
```

Но мы всегда подключаем скрипты в конце body, поэтому вы вряд ли столкнётесь с такой проблемой.

## Экспорт и импорт из модулей

### Экспорт из модуля

Отдельные переменные и функции этого модуля нужно сделать доступными для подключения в других файлах — экспортировать их \
Gеред переменной, функцией или классом, которые нужно экспортировать, добавляют директиву **export**

Файл script-01.js

```javascript
export const str = "Я переменная из модуля script-01.js";

export function myFunc() {
  console.log("Я функция из модуля script-01.js");
}
```

### Импорт в модуль

Функции или классы модуля нужно получить внутри другого модуля. \
Для этого есть директива **import**, которая позволяет обращаться к переменным в других файлах

Файл script-02.js

```javascript
// импортируем переменную и функцию по их именам
import { str, myFunc } from "./script-01.js";

// теперь их можно использовать

console.log(str); // "Я переменная из модуля script-01.js"
myFunc(); // "Я функция из модуля script-01.js"
```

❗Чтобы всё заработало, нужно установить локальный сервер, как вы делали в теме про Webpack, иначе файлы не подключатся, а в консоль повалятся ошибки.
